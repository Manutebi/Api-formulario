<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css">

    <title>Formulario3</title>
</head>
<body>
    <div class="container mt-5">
        <h3 class="text-center mb-4">Formulario</h3>
        <form id="product-form" class="row g-3">
            <div class="col-md-6">
                <label for="nombre" class="form-label">Nombre:</label>
                <input type="text" id="nombre" name="Nombre" class="form-control">
            </div>
            <div class="col-md-6">
                <label for="descripcion" class="form-label">Descripci√≥n:</label>
                <input type="text" id="descripcion" name="Descripcion" class="form-control">
            </div>
            <div class="col-md-6">
                <label for="precio" class="form-label">Precio:</label>
                <div class="input-group">
                    <span class="input-group-text">$</span>
                    <input type="number" id="precio" name="Precio" class="form-control">
                </div>
            </div>

            <div class="col-md-6">
                <label for="opciones" class="form-label">Opciones:</label>
                <select id="Opciones" name="Opciones" class="form-control">
                </select>
            </div>
            
            <div style="display: none;" class="col-md-6">
                <label for="table2" class="form-label">Table2:</label>
                <input type="text" id="table2" name="table2" class="form-control">
            </div>
            <div class="col-md-6">
                <label for="name" class="form-label">Name:</label>
                <input type="text" id="name" name="name" class="form-control" disabled>
            </div>

            <div class="col-md-6">
                <label for="name2" class="form-label">Name2:</label>
                <input type="text" id="name2" name="name2" class="form-control">
            </div>

            <div class="col-md-6">
                <label for="notes" class="form-label">Notes:</label>
                <input type="text" id="notes" name="notes" class="form-control" >
            </div>

            <!-- <div class="col-md-6">
                <label for="assignee" class="form-label">Assignee:</label>
                <input type="text" id="assignee" name="assignee" class="form-control" disabled>
            </div> -->

            <div class="col-md-6">
                <label for="status" class="form-label">Status:</label>
                <select id="status" name="status" class="form-control">
                </select>    
            </div>

            <input type="file" id="imagen" name="imagen">

            <div style="text-align: left;" class="col-12">
                <button type="submit" id="submit" class="btn btn-primary">Enviar</button>
            </div>

            <div style="text-align: left;" class="col-12">
                <button type="submit" class="btn btn-primary">Modificar</button>
            </div>
            <div style="text-align: left;" class="col-12">
                <button type="submit" class="btn btn-secondary">Ingresar</button>
            </div>
            
        </form>
    </div>


    <script>
    document.getElementById("imagen").addEventListener("change", function(event) {
    const file = event.target.files[0];
    console.log(file);
    });

    function subirImagen(file) {
    const formData = new FormData();
    formData.append("file", file);

    return fetch("https://api.miservidordeimagenes.com/upload", {
        method: "POST",
        body: formData
    })
    .then(response => response.json())
    .then(data => {
        console.log(data.url);
        return data.url;
    })
    .catch(error => {
        console.error(error);
    });
    }


    document.getElementById("formulario").addEventListener("submit", function(event) {
    event.preventDefault();

    const file = document.getElementById("imagen").files[0];
    subirImagen(file)
    .then(url => {
        const nombre = document.getElementById("nombre").value;
        const descripcion = document.getElementById("descripcion").value;
        const precio = document.getElementById("precio").value;
        const opciones = document.getElementById("opciones").value;
        const name = document.getElementById("name").value;
        const table2 = document.getElementById("table2").value;

        const data = {
            "fields": {
            "Nombre": nombre,
            "Descripcion": descripcion,
            "Precio": precio,
            "Opciones": opciones,
            "Name": name,
            "Table2": [table2],
            "Imagen": [{url: url}]
        }
        };

        const options = {
        method: "PATCH",
        headers: {
            "Authorization": "Bearer keykY5YjFxN23izT6",
            "Content-Type": "application/json"
        },
        body: JSON.stringify(data)
        };

        fetch(`https://api.airtable.com/v0/appU7lYsFSoNH4hGO/Productos/${ID}`, options)
        .then(response => response.json())
        .then(data => {
        console.log(data);
        })
        .catch(error => {
        console.error(error);
        });
    });
});



    </script>
    <script src="app.js"></script>
</body>
</html>
